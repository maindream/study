## 도커 소개

### 도커란?
 
Docker는 어떤 애플리케이션이든 쉽게 배포 패키지를 만들고, 어떤 대규모 환경에서든 배포할 수 있으며, 빠르게 돌아가는 개발 조직의 작업 절차를 기민하고 효과적으로 수행하도록 도와주는 도구(플랫폼)이다. Docker는 소프트웨어를 **Container**라는 표준화된 유닛으로 **Packaging**하며, 이 Container에는 라이브러리, 시스템 도구, 코드, 런타임 등 소프트웨어를 실행하는 데 필요한 모든 것이 포함되어 있다. 또한 **계층화**된 파일 시스템([AUFS](https://ko.wikipedia.org/wiki/Aufs), [BTRFS](https://en.wikipedia.org/wiki/Btrfs) 등)을 사용해 가상화된 Container의 변경 사항을 모두 추적하고 관리한다. Docker를 사용하면 환경에 구애받지 않고 애플리케이션을 신속하게 배포 및 확장할 수 있으며 애플리캐이션이 어느 환경에서나 문제없이 실행될 것을 보장한다. 

> 도커는 애플리케이션을 쉽게 구축, 테스트 및 배포할 수 있는 소프트웨어 플랫폼이다.

### 도커의 역사

도커는 2013년 3월 산타클라라에서 열린 Pycon Conference에서 dotCloud의 창업자인 Solomon Hykes가 'The future of Linux Containers'라는 세션을 발표하면서 처음 세상에 알려졌다.

이 발표 이후 도커가 인기를 얻으면서 당해 10월 회사이름을 도커로 바꾸고 2014년 6월 1.0을 발표했다. 2014년 8월 도커에 집중하기 위해 dotCloud 플랫폼을 매각하고 2015년 4월 약 1,100억원 투자를 유치한 후 계속해서 빠르게 성장하고 있다. 

### 도커의 전망

표면적으로 도커는 가상화 플랫폼으로 인식되지만, 실제로는 그보다 훨씬 대단한 것이다. 도커는 이미 잘 알려진 [KVM](https://www.linux-kvm.org/page/Main_Page), 젠([Xen](https://en.wikipedia.org/wiki/Xen)), 오픈스택([OpenStack](https://en.wikipedia.org/wiki/OpenStack)), 메소스(Mesos), 카피스트라노([Capistrano](https://en.wikipedia.org/wiki/Capistrano_(software))), 페브릭(Fabric), 앤시블(Ansible), 셰프(Chef), 퍼핏(Puppet), 솔트스택(SaltStack) 등을 포함한 여러 인기 있는 기술 영역에 걸쳐 있다. 

작은 조직이라도 팀원들 간에 커뮤니케이션과 일 처리가 원활하게 돌아가는 것은 꽤 어렵고 비용도 많이 들어가는 일이다. 하지만 이제는 팀 내에서 치밀하게 정보를 소통하는 일이 중요한 세상이 되었다. 개발자들은 소프트웨어를 출시하는 수많은 환경의 복잡성에 관해 이해해야 하며, 제품 운영팀은 출시할 소프트웨어의 내부 구조를 알아야 할 필요성이 점점 커지고 있다. 그러므로 안정적인 소프트웨어 개발에 도움이 되면서 커뮤니케이션의 복잡성을 줄일 수 있는 도구가 인기를 얻을 것이다. 

도커는 커뮤니케이션 문제를 도와주는 것 이상으로 매우 안정적으로 애플리케이션을 개발할 수 있도록 소프트웨어 아키텍처를 구축하는 데에 독보적인 소프트웨어다. 아키텍처 철학의 중심에는 원자적(atomic)이면서 쉽게 쓰고 버릴 수 있는 Container 개념이 있다. 배포 과정에서 기존의 배포된 애플리케이션의 모든 실행 환경은 다 같이 폐기한다. 또한 일시적인 디버깅용 수정 사항이 로컬 파일 시스템에 남아 있다가 차기 릴리스에 함께 섞여 들어갈 가능성도 줄어든다. 모든 상태가 직접 배포 결과물에 포함되고, 수정 불가능한 상태가 되어야 하며, 그대로 데이터베이스나 캐시, 파일 서버 같은 외부 의존 대상으로 전송되므로 서버끼리 주고받기가 매우 쉬워진다. 

### 도커 워크플로의 장점

도커를 사용하면 호스팅 시스템 관점에서 모든 애플리케이션은 본질적으로 외부에서 동일하게 보이므로 아키텍처적인 의사결정을 더 단순하게 만들어 준다. 도커를 사용함으로써 얻을 수 있는 장점 몇 가지를 소개하겠다.

- **개발자들이 가진 기술을 극대화하는 방향으로 소프트웨어를 패키징**
:  각기 다른 플랫폼에 대해 소프트웨어 패키징에 필요한 모든 지식과 도구들을 따로 배우지 않아도 된다. 도커는 모든 요구 사항을 단일 파일에 정의(Dockerfile)하고 하나의 패키지로 묶어서 관리한다.

- **애플리케이션과 관련 OS파일 시스템을 하나의 표준화된 이미지 포맷으로 통합**
:  과거에는 대개 애플리케이션뿐 아니라 라이브러리들과 데몬(daemon)을 포함한 많은 의존성들을 함께 패키징해야 했다. 그럼에도 불구하고 늘 실행 환경이 100% 동일하다는 것을 장담하기는 힘들었다. 도커를 쓰면 애플리케이션과 함께 필요한 파일들도 개별적으로 설치할 수 있어, 애플리케이션이 기대한 환경에서 돌아가는 것을 보장해준다. 

- **패키징 결과물을 모든 시스템과 환경에 대해 동일한 결과물로 테스트하고 배포하는 데 사용**
: 개발자가 변경 내역을 버전 관리 시스템에 커밋하면 새로운 도커 이미지를 빌드할 수 있으며, 모든 테스트 과정 및 실행 환경에 재컴파일이나 재빌드 없이 배치해서 쓸 수 있다. 

- **자원 낭비 없이 하드웨어로부터 소프트웨어 애플리케이션을 추상화**
: VM웨어 같은 전통적인 가상화 솔루션들은 물리적인 하드웨어와 그 위에서 실행되는 소프트웨어 애플리케이션 사이에 추상화 계층을 두기 위해 쓰인다. 그래서 그만큼 자원을 소비한다. VM들을 관리하는 하이퍼바이저([hypervisor](https://en.wikipedia.org/wiki/Hypervisor))와 각 VM들이 실행 중인 커널(kernel)은 하드웨어 시스템 자원의 일부를 점유하고, 이 자원들은 호스트의 애플리케이션들이 쓸 수 없다. 반면, Container는 단지 리눅스 커널과 직접 통신하는 또 다른 *프로세스*에 불과하므로 자원 낭비가 없다. 

### 도커가 대신할 수 없는 것

비록 도커가 전통적인 도구들을 대체할 수 있다 하더라도 도커의 진정한 힘은 그런 도구들과 호환, 혹은 병행 사용하면서 더 강력한 효과를 발휘할 수 있다. 아래에서 도커가 직접적으로 대신할 수는 없지만 함께 연동해 쓰면 훨씬 높은 퍼포먼스를 보이는 도구들을 살펴보겠다.

- **엔터프라이즈 가상화 플랫폼 - VM웨어, KVM 등**
 : 컨테이너(Container)는 전통적 의미의 가상 머신이 아니다. 가상 머신은 하나의 완전한 OS를 포함하고 있으며, 호스트 OS 위에서 돌아간다. 컨테이너는 호스트와 컨테이너가 동일한 커널(OS의 핵심 기능(CPU 스케줄링, 메모리 관리 등)을 가진 모듈)을 공유한다. 이는 컨테이너가 훨씬 적은 시스템 자원을 사용하지만, 반드시 동일한 OS(리눅스)에 기반을 둬야만 한다는 것이다.

- **클라우드 플랫폼 - 오픈스택(OpenStack), 클라우드 스택(CloudStack) 등**
 : 도커는 클라우드 플랫폼과 유사성이 많다. 하지만 오직 존재하는 도커 호스트 머신의 컨테이너들에 대해서만 배포하고 실행하고 관리해 준다. 새로운 호스트 시스템, 객체 저장소, 블록 저장소, 그 외 클라우드 플랫폼에서 흔히 쓰이는 다른 자원들을 도커에서 생성하는 것은 불가능하다. 

- **설정 관리 - 퍼핏(Puppet), 셰프(Chef)등**
 : 도커는 애플리케이션과 그 의존성을 관리하는 역량을 높여 주지만, 전형적인 기존의 설정 관리를 직접적으로 대신하지는 않는다. 도커파일(Dockerfile)은 빌드 시에 컨테이너를 어떻게 구성할지 정의하지만, 컨테이너의 실행 상태를 관리하지는 않으며 도커의 호스트 시스템을 관리할 수도 없다. 

- **배포 프레임워크 - 카피스트라노(Capistrano), 페브릭(Fabric)등**
 : 도커는 애플리케이션과 모든 의존성을 자체적으로 갖고 있고 모든 환경에 수정 없이 배포될 수 있는 컨테이너 이미지를 써서 배포 작업의 많은 부분을 쉽게 만들 수 있다. 하지만 자체적으로 복잡한 배포 과정을 완전히 자동화시켜 주지는 않는다. 

- **작업 부하 관리 도구 - 메소스(Mesos), 플리트(Fleet)등**
 : 도커 서버는 내부적으로 클러스터 개념이 없다. 추가적인 조정 도구(도커 자체의 Swarm 등)을 써서 반드시 도커 호스트 풀(pool) 내에서 작업을 효과적으로 배분해야 하며, 모든 호스트와 자원 상태를 추적하고 실행 중인 컨테이너들의 목록을 유지해야 한다. 

- **개발 환경 - 베이그란트(Vagrant) 등**
 : 베이그란트(Vagrant)는 개발자들을 위한 가상 머신 관리 도구이다. 무엇보다 리눅스 소프트웨어를 맥OS나 윈도우 기반 워크스테이션에서 실행하기 쉽게 만들어 준다. 도커에서도 Boot2Docker라는 도구를 제공했지만, 도커 머신(Docker machine)과 베이그란트에서 제공하는 것만큼 많은 기능을 제공하지는 않는다. 

---
### Reference
- [https://aws.amazon.com/ko/docker/](https://aws.amazon.com/ko/docker/)
- [https://subicura.com/2017/01/19/docker-guide-for-beginners-1.html](https://subicura.com/2017/01/19/docker-guide-for-beginners-1.html)
- [https://blog.nacyot.com/articles/2014-01-27-easy-deploy-with-docker/](https://blog.nacyot.com/articles/2014-01-27-easy-deploy-with-docker/)
- O'REILLY Docker Up & Running (Karl Mattias, Sean P. Kane)
- [Wikipedia](https://en.wikipedia.org)

### Futher Reading
- [클라우드 플랫폼 종류](http://library.gabia.com/contents/infrahosting/2257)
- [클러스터 소개](http://www.gurubee.net/lecture/1114)